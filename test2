def _extract_taxonomy_descs(raw: Dict[str, Any]) -> List[str]:
    taxonomies = raw.get("taxonomies") or []
    descs: List[str] = []
    if isinstance(taxonomies, list):
        for t in taxonomies:
            if not isinstance(t, dict):
                continue
            d = t.get("desc")
            if isinstance(d, str) and d.strip():
                descs.append(d.strip().lower())
    return descs


def _is_excluded_specialty(raw: Dict[str, Any]) -> bool:
    keywords = getattr(settings, "NPI_EXCLUDE_SPECIALTY_KEYWORDS", None) or []
    keywords = [k.strip().lower() for k in keywords if isinstance(k, str) and k.strip()]
    if not keywords:
        return False

    descs = _extract_taxonomy_descs(raw)
    if not descs:
        return False

    joined = " | ".join(descs)
    return any(kw in joined for kw in keywords)
----------------------------------------------
def normalize_npi_results(raw: Dict[str, Any]) -> Optional[Dict[str, Any]]:
================================
